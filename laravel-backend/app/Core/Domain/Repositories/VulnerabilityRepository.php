<?php

namespace App\Core\Domain\Repositories;

use App\Models\Vulnerability;
use Illuminate\Support\Collection;

class VulnerabilityRepository
{
    public function all(): Collection
    {
        return Vulnerability::all();
    }

    public function findById(string $id): ?Vulnerability
    {
        return Vulnerability::find($id);
    }

    public function create(array $data): Vulnerability
    {
        return Vulnerability::create($data);
    }

    public function update(string $id, array $data): ?Vulnerability
    {
        $vulnerability = Vulnerability::find($id);
        if ($vulnerability) {
            $vulnerability->update($data);
        }
        return $vulnerability;
    }

    public function delete(string $id): bool
    {
        $vulnerability = Vulnerability::find($id);
        if ($vulnerability) {
            return $vulnerability->delete();
        }
        return false;
    }

    public function findByRepositoryId(string $repositoryId): Collection
    {
        return Vulnerability::where('repository_id', $repositoryId)->get();
    }

    public function findBySeverity(string $severity): Collection
    {
        return Vulnerability::where('severity', $severity)->get();
    }

    public function findByStatus(string $status): Collection
    {
        return Vulnerability::where('status', $status)->get();
    }
}
